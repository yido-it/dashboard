<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<!--1번째컨텐츠-->
<div class="content_01">
	<div class="content_01-2 content01_golf_boeun" >
		<!-- <div class="title_month">YIDO 매출비율</div> -->
		<div class="tc mt50" style="font-size: 40px; color: #fff; font-weight: bold;">CLUBD BOEUN Country Club</div>
		<h2 class="tc colorwhite fs18"  style="line-height:29px;margin-top:30px">
			 자연속에서 '최고의 휴식'을 만들어 내는 것입니다.<br/>보다 안전하고, 편리한 삶을 만들기 위해 노력하는 기업입니다.  
		</h2>
		<h2 class="tc colorwhite fs18"  style="margin-top: 15px; font-weight: bold;">
			18Hole / Par 72 (6,163m)
		</h2>
		<!-- <div class="mt20">
			<video style="width:33%" autoplay="" loop="" muted="" playsinline="" preload="" src="resource/images/env/video/video_c1_2.mp4"></video>
			<video style="width:33%" autoplay="" loop="" muted="" playsinline="" preload="" src="resource/images/env/video/video_c1_1.mp4"></video>
			<video style="width:33%" autoplay="" loop="" muted="" playsinline="" preload="" src="resource/images/env/video/video_c2_2.mp4"></video>
		 </div> -->
	</div>
	<%@include file="content01/golf.jsp"%>
</div>
<!--50%컨텐츠-->
<div class="content_50" style="background: url(resource/images/bg.jpg) no-repeat 0% 0;">
	<!-- <div class="title_month" style="padding:1%">YIDO 사업장</div> -->
	<div class="container tc" style="position: relative">
		<img class="" style="width: 100%; height: 1000px" src="resource/images/golf/map_boeun.png" style="visibility: visible;">
		<!--보은eaST-->
		<div class="BoeunEast cart_map">
			<p class="triangle-right be01_1 A10"></p>
			<img class="img_cart be01_1" src="resource/images/golf/cart.png" />
			<p class="triangle-right be01_2 A11"></p>
			<img class="img_cart be01_2" src="resource/images/golf/cart.png" />
			<p class="triangle-right be01_3 A12"></p>
			<img class="img_cart be01_3" src="resource/images/golf/cart.png" />
			<p class="triangle-right be01_4 A13"></p>
			<img class="img_cart be01_4" src="resource/images/golf/cart.png" />
			<p class="triangle-right be02_1 A20"></p>
			<img class="img_cart be02_1" src="resource/images/golf/cart.png" />
			<p class="triangle-right be02_2 A21"></p>
			<img class="img_cart be02_2" src="resource/images/golf/cart.png" />
			<p class="triangle-right be02_3 A23"></p>
			<img class="img_cart be02_3" src="resource/images/golf/cart.png" />
			<p class="triangle-right be03_1 A30"></p>
			<img class="img_cart be03_1" src="resource/images/golf/cart.png" />
			<p class="triangle-right be03_2 A33"></p>
			<img class="img_cart be03_2" src="resource/images/golf/cart.png" />
			<p class="triangle-right be04_1 A40"></p>
			<img class="img_cart be04_1" src="resource/images/golf/cart.png" />
			<p class="triangle-right be04_2 A41"></p>
			<img class="img_cart be04_2" src="resource/images/golf/cart.png" />
			<p class="triangle-right be04_3 A43"></p>
			<img class="img_cart be04_3" src="resource/images/golf/cart.png" />
			<p class="triangle-right be05_1 A50"></p>
			<img class="img_cart be05_1" src="resource/images/golf/cart.png" />
			<p class="triangle-right be05_2 A51"></p>
			<img class="img_cart be05_2" src="resource/images/golf/cart.png" />
			<p class="triangle-right be05_3 A53"></p>
			<img class="img_cart be05_3" src="resource/images/golf/cart.png" />
			<p class="triangle-right be06_1 A60"></p>
			<img class="img_cart be06_1" src="resource/images/golf/cart.png" />
			<p class="triangle-right be06_2 A61"></p>
			<img class="img_cart be06_2" src="resource/images/golf/cart.png" />
			<p class="triangle-right be06_3 A63"></p>
			<img class="img_cart be06_3" src="resource/images/golf/cart.png" />
			<p class="triangle-right be07_1 A70"></p>
			<img class="img_cart be07_1" src="resource/images/golf/cart.png" />
			<p class="triangle-right be07_2 A71"></p>
			<img class="img_cart be07_2" src="resource/images/golf/cart.png" />
			<p class="triangle-right be07_3 A72"></p>
			<img class="img_cart be07_3" src="resource/images/golf/cart.png" />
			<p class="triangle-right be07_4 A73"></p>
			<img class="img_cart be07_4" src="resource/images/golf/cart.png" />
			<p class="triangle-right be08_1 A80"></p>
			<img class="img_cart be08_1" src="resource/images/golf/cart.png" />
			<p class="triangle-right be08_2 A83"></p>
			<img class="img_cart be08_2" src="resource/images/golf/cart.png" />
			<p class="triangle-right be09_1 A90"></p>
			<img class="img_cart be09_1" src="resource/images/golf/cart.png" />
			<p class="triangle-right be09_2 A91"></p>
			<img class="img_cart be09_2" src="resource/images/golf/cart.png" />
			<p class="triangle-right be09_3 A93"></p>
			<img class="img_cart be09_3" src="resource/images/golf/cart.png" />
		</div>
		<!--보은WEST-->
		<div class="BoeunWest cart_map">
			<p class="triangle-right bw01_1 B10"></p>
			<img class="img_cart bw01_1" src="resource/images/golf/cart.png" />
			<p class="triangle-right bw01_2 B11"></p>
			<img class="img_cart bw01_2" src="resource/images/golf/cart.png" />
			<p class="triangle-right bw01_3 B13"></p>
			<img class="img_cart bw01_3" src="resource/images/golf/cart.png" />
			<p class="triangle-right bw02_1 B20"></p>
			<img class="img_cart bw02_1" src="resource/images/golf/cart.png" />
			<p class="triangle-right bw02_2 B21"></p>
			<img class="img_cart bw02_2" src="resource/images/golf/cart.png" />
			<p class="triangle-right bw02_3 B23"></p>
			<img class="img_cart bw02_3" src="resource/images/golf/cart.png" />
			<p class="triangle-right bw03_1 B30"></p>
			<img class="img_cart bw03_1" src="resource/images/golf/cart.png" />
			<p class="triangle-right bw03_2 B33"></p>
			<img class="img_cart bw03_2" src="resource/images/golf/cart.png" />
			<p class="triangle-right bw04_1 B40"></p>
			<img class="img_cart bw04_1" src="resource/images/golf/cart.png" />
			<p class="triangle-right bw04_2 B41"></p>
			<img class="img_cart bw04_2" src="resource/images/golf/cart.png" />
			<p class="triangle-right bw04_3 B43"></p>
			<img class="img_cart bw04_3" src="resource/images/golf/cart.png" />
			<p class="triangle-right bw05_1 B50"></p>
			<img class="img_cart bw05_1" src="resource/images/golf/cart.png" />
			<p class="triangle-right bw05_2 B51"></p>
			<img class="img_cart bw05_2" src="resource/images/golf/cart.png" />
			<p class="triangle-right bw05_3 B52"></p>
			<img class="img_cart bw05_3" src="resource/images/golf/cart.png" />
			<p class="triangle-right bw05_4 B53"></p>
			<img class="img_cart bw05_4" src="resource/images/golf/cart.png" />
			<p class="triangle-right bw06_1 B60"></p>
			<img class="img_cart bw06_1" src="resource/images/golf/cart.png" />
			<p class="triangle-right bw06_2 B61"></p>
			<img class="img_cart bw06_2" src="resource/images/golf/cart.png" />
			<p class="triangle-right bw06_3 B63"></p>
			<img class="img_cart bw06_3" src="resource/images/golf/cart.png" />
			<p class="triangle-right bw07_1 B70"></p>
			<img class="img_cart bw07_1" src="resource/images/golf/cart.png" />
			<p class="triangle-right bw07_2 B73"></p>
			<img class="img_cart bw07_2" src="resource/images/golf/cart.png" />
			<p class="triangle-right bw08_1 B80">4</p>
			<img class="img_cart bw08_1" src="resource/images/golf/cart.png" />
			<p class="triangle-right bw08_2 B81"></p>
			<img class="img_cart bw08_2" src="resource/images/golf/cart.png" />
			<p class="triangle-right bw08_3 B82"></p>
			<img class="img_cart bw08_3" src="resource/images/golf/cart.png" />
			<p class="triangle-right bw08_4 B83"></p>
			<img class="img_cart bw08_4" src="resource/images/golf/cart.png" />
			<p class="triangle-right bw09_1 B90"></p>
			<img class="img_cart bw09_1" src="resource/images/golf/cart.png" />
			<p class="triangle-right bw09_2 B91"></p>
			<img class="img_cart bw09_2" src="resource/images/golf/cart.png" />
			<p class="triangle-right bw09_3 B93"></p>
			<img class="img_cart bw09_3" src="resource/images/golf/cart.png" />
		</div>
		<!--일일현황보고서-->
		<div class="golfday_wrap">
			<div class="div_box">
				<div class="top_txt">
					<h1 class="colorwhite">
						일일현황보고서 <span class="fr" id="today" style="font-size: 24px;"></span>
					</h1>
				</div>
				<ul class="ul_data">
					<li><span class="fl tit">팀수</span>
						<div class="fr box bg_red">
							<span class="bold num"><span class="counter_status" id="enTeam">0</span>/ <span id="bookTeam">0</span></span> <span class="unit">팀</span>
						</div></li>
					<li><span class="fl tit">내장인원</span>
						<div class="fr box bg_blue">
							<span class="bold num counter_status" id="enCnt">0</span> <span class="unit">명</span>
						</div></li>
					<li><span class="fl tit">매출</span>
						<div class="fr box bg_green">
							<span class="bold num counter_status" id="amt">0</span> <span class="unit">만원</span>
						</div></li>
				</ul>
				<div class="cb"></div>
			</div>
		</div>
		<!--//일일현황보고서-->
	</div>
</div>
<!--//50%컨텐츠-->
<!--4번째컨텐츠-->
<div class="content_04">
	<div class="content_04-1">
		<div class="title_month">
			CLUBD 보은
			<num id="yyMm"></num>
			Business Status
		</div>
		<ul class="section_data">
			<li>
				<p>매출</p> <span class="counter_status" id="saleAmt"></span>억 <br>
				<div class="year_count">
					계획
					<h10 id="planAmt"> </h10>
					억
				</div> <!-- 차트 -->
				<div id="chartdiv1" class="chartDiv"></div>
			</li>
			<li>
				<p style="width: 98px;">예약팀수</p> <span class="counter_status" id="bookTeeup"></span>팀 <br>
				<div class="year_count">
					전체팀수
					<h10 id="allTeeup"> </h10>
					팀
				</div>
				<div id="chartdiv2" class="chartDiv"></div>
			</li>
			<li>
				<p>내장객</p> <span class="counter_status" id="enCnts"></span>명 <br>
				<div class="year_count"></div>
				<div id="chartdiv5" class="chartDiv"></div>
			</li>
			<li>
				<p>객단가</p> <span class="counter_status" id="allPerson"></span>원 <br>
				<div class="year_count"></div>
				<div id="chartdiv6" class="chartDiv"></div>
			</li>
		</ul>
	</div>
	<div class="content_04-2" style="background: url(resource/images/bg.jpg) no-repeat 0% 88%;">
		<video style="width: 100%; position: relative; height: 489px;" autoplay="" loop="" muted="" playsinline="" preload="" src="resource/images/golf/boeun.mp4"></video>
	</div>
</div>
<!--//4번째컨텐츠-->

<script type="text/javascript">
	$(document).ready(function (e){
		getDashboardInfo();
		getDashboardCart();
		getDashboardStatus();
		getDashboardLine();
		
	});
	
	var sUrl1 = "http://101.101.160.40:8080/dash/getDashboardInfo.do";
	var sUrl2 = "http://101.101.160.40:8080/dash/getDashboardCart.do";
	var sUrl3 = "http://101.101.160.40:8080/dash/getDashboardStatus.do";
	var sUrl4 = "http://101.101.160.40:8080/dash/getDashboardLine.do";
//	var sUrl1 = "http://10.10.85.83:8080/dash/getDashboardInfo.do";
//	var sUrl2 = "http://10.10.85.83:8080/dash/getDashboardCart.do";
//	var sUrl3 = "http://10.10.85.83:8080/dash/getDashboardStatus.do";
//	var sUrl4 = "http://10.10.85.83:8080/dash/getDashboardLine.do";
	var sParams = {};
	var arr = [];
	
	dashboard = setInterval(function(){
		getDashboardInfo();
		getDashboardCart();
        }, 5000);
	
	dashboard2 = setInterval(function(){
		getDashboardStatus();
		getDashboardLine();
        }, 30000);
	
    function getDashboardInfo(){
    	sParams["coDiv"] = '01';
    	$.get(sUrl1, sParams, function(result) {
    		var data = JSON.parse(result)
			var d = new Date();
    	    if(data.resultCode == "0000") {

    	        $('#today').text(data.rows[0].TODAY +' ' + d.getHours() + ":" + (d.getMinutes() < 10 ? '0' + d.getMinutes() : d.getMinutes()));
    	        $('#enTeam').text(data.rows[0].EN_TEAM);
    	        $('#bookTeam').text(data.rows[0].BOOK_TEAM);
    	        $('#enCnt').text(data.rows[0].EN_CNT);
    	        $('#amt').text(data.rows[0].AMT);

    	    }
    	});
    }
    
    
    function getDashboardCart(){
    	sParams["coDiv"] = '01';
    	$.get(sUrl2, sParams, function(result) {
    		var data = JSON.parse(result)
			var d = new Date();
    	    if(data.resultCode == "0000") {
//     	    	var temp = [];
//     	    	var uniqueArr = [];
//     	    	var uniqueArr2 = [];
//     	    	data.rows.forEach(function(item, index){
// 	    			var dataCart = item.CURRENTCOURSE + item.CURRENTHOLE + item.CURRENTPAR;
// 	    			temp.push(dataCart);
// 	    		})
//     	    	if(data.rows.length != arr.length){
//     	    		arr = [];
    	    		$(".cart_map p, .cart_map img").hide();
    	    		data.rows.forEach(function(item, index){
    	    			var dataCart = item.CURRENTCOURSE + item.CURRENTHOLE + item.CURRENTPAR;
//     	    			arr.push(dataCart);
   	    	     		
    	    			$(".cart_map ."+dataCart).html(item.CART_NO).show().next().show();
    	    		})
//     	    	}else{
//     	    		$.each(arr.sort(), function(i, el){
// 	        		    if($.inArray(el, uniqueArr) === -1) uniqueArr.push(el);
// 	        		});
// 	        		$.each(temp.sort(), function(i, el){
// 	        		    if($.inArray(el, uniqueArr2) === -1) uniqueArr2.push(el);
// 	        		});
					
// 	        		console.log(uniqueArr);
// 	        		console.log(uniqueArr2);

// 	        		data.rows.forEach(function(item, index){
// 	    	        	var dataCart = item.CURRENTCOURSE + item.CURRENTHOLE + item.CURRENTPAR;
// 	    	        	var idx = uniqueArr.indexOf(dataCart);
// 	    	        	var idx2 = uniqueArr2.indexOf(dataCart);
	    	        	
// 	    	        	console.log(arr[index], data.rows[index].CURRENTCOURSE+data.rows[index].CURRENTHOLE+data.rows[index].CURRENTPAR);
	    	        	
// 	    	        	if(idx == -1 ){
// 	    	        		//같은게 없을때
// 	    	        		var removed = uniqueArr.splice(idx2, 1, dataCart);
// 	    	        		$(".cart_map ."+removed).html("0").hide().next().hide();
// 	    	        		$(".cart_map ."+dataCart).html(item.CART_NO).show().next().show();
// 	    	        		arr = uniqueArr;
// 	    	        	}else{
	    	        		
// 	    	        	}
	    	        	
// 	    	        })
//     	    	}

    	    }
    	    
    	});
    }
    
    function getDashboardStatus(){
    	sParams["coDiv"] = '01';
    	var text1 = "";
    	var text2 = "";
    	$.get(sUrl3, sParams, function(result) {
    		var data = JSON.parse(result)
			var d = new Date();
    	    if(data.resultCode == "0000") {
    	    	var item = data.rows[0];
    	    	$("#yyMm").html(item.YY_MM); 		//전체팀수
    	    	$("#allTeeup").html(numberWithCommas(item.ALL_TEEUP)); 		//전체팀수
    	    	$("#bookTeeup").html(numberWithCommas(item.BOOK_TEEUP)); 		//예약팀수
    	    	$("#bookPer").html(numberWithCommas(item.BOOK_PER)); 			//예약율
    	    	$("#enCnts").html(numberWithCommas(item.EN_CNT)); 			//내장객수
    	    	$("#allPerson").html(numberWithCommas(item.ALL_PERSON));  //객단가
    	    	var planAmt = (item.PLAN_AMT/100000000).toFixed(2)
    	    	$("#planAmt").html(planAmt); 	//계획매출
    	    	var saleAmt = (item.SALE_AMT/100000000).toFixed(2)
    	    	$("#saleAmt").html(numberWithCommas(saleAmt)); 	//매출
    	    	text1 = (saleAmt / planAmt * 100).toFixed(1);
    	    	text2 = (item.BOOK_TEEUP / item.ALL_TEEUP * 100).toFixed(1);
    	    	
    	    	div1 = [{ 
      			  "value": text1,
      			  "fill":"yellow" 
      			}, {
      			  "value": 100-text1,
      			  "fill":"#ffffff"
      			}];
      			div2 = [{ 
      			  "value": text2,
      			  "fill":"#00ffcc" 
      			}, {
      			  "value": 100-text2,
      			  "fill":"#ffffff"
      			}];
    	    }
    	}).done(function(){
    		golfPieChart("chartdiv1", div1, text1 + "%");
			golfPieChart("chartdiv2", div2, text2 + "%");  
    		
    	})
    }
    
    function getDashboardLine(){
    	var lineData = [];
    	var lineData2 = [];
    	sParams["coDiv"] = '01';
    	$.get(sUrl4, sParams, function(result) {
    		var data = JSON.parse(result)
			var d = new Date();
    	    if(data.resultCode == "0000") {
    	    	data.rows.forEach(function(item){
	    	    	console.log(item);
	    	    	lineData.push({date: item.month.replace(/(^0+)/, ""), value1 : item.EN_CNT});
    	    		lineData2.push({date: item.month.replace(/(^0+)/, ""), value1 : item.ALL_PERSON});
    	    	});
    	    }
    	    
   	    }).done(function(){
   	    	golfLineChart("chartdiv5", lineData);
    	    golfLineChart2("chartdiv6", lineData2);
    	    
    	    $('.counter_status').counterUp({
                delay: 10,
                time: 1000
            });
   	    });
    }
    
 
 
 <!--지도액션추가 -->
		
	function golfPieChart(div, data, txt){
		// Create chart instance
		var chart = am4core.create(div, am4charts.PieChart);

		// Let's cut a hole in our Pie chart the size of 40% the radius
		chart.innerRadius = am4core.percent(40);

		chart.innerRadius = 100;
		var label = chart.seriesContainer.createChild(am4core.Label);
		label.text = txt;
		label.horizontalCenter = "middle";
		label.verticalCenter = "middle";
		label.fontSize = 50;


		// Add and configure Series
		var pieSeries = chart.series.push(new am4charts.PieSeries());
		pieSeries.dataFields.value = "value";
		pieSeries.dataFields.category = "category";
		pieSeries.slices.template.stroke = am4core.color("#010");
		pieSeries.innerRadius = 10;
		pieSeries.slices.template.fillOpacity = 0.8;
		pieSeries.slices.template.propertyFields.fill = "fill";

		pieSeries.slices.template.propertyFields.disabled = "labelDisabled";
		pieSeries.labels.template.propertyFields.disabled = "labelDisabled";
		pieSeries.ticks.template.propertyFields.disabled = "labelDisabled";


		// Add data
		pieSeries.data = data;

		// Disable sliding out of slices
		pieSeries.slices.template.states.getKey("hover").properties.shiftRadius = 0;
		pieSeries.slices.template.states.getKey("hover").properties.scale = 1;


		pieSeries.adapter.add("innerRadius", function(innerRadius, target){
		  return am4core.percent(10);
		})


		pieSeries.adapter.add("radius", function(innerRadius, target){
		  return am4core.percent(100);
		})  
	}
  
	function golfLineChart(div, data){
		// Create chart instance
		var chart = am4core.create(div, am4charts.XYChart);
		// Add data
		chart.data = data;
		
		var categoryAxis = chart.xAxes.push(new am4charts.CategoryAxis());
		categoryAxis.dataFields.category = "date";
		categoryAxis.renderer.minGridDistance = 10;
		
		
		var valueAxis = chart.yAxes.push(new am4charts.ValueAxis());
		
		// Create series
		var series = chart.series.push(new am4charts.LineSeries());
		series.dataFields.valueY = "value1";
		series.dataFields.categoryX = "date";
		series.strokeWidth = 3;
		series.minBulletDistance = 10;
		series.tooltipText = "[bold]내장객:[/] {value1}";
		series.tooltip.pointerOrientation = "vertical";
		
		// Add cursor
		chart.cursor = new am4charts.XYCursor();
		//chart.cursor.xAxis = dateAxis;  
		chart.cursor.xAxis = categoryAxis;  
	 }
	
	function golfLineChart2(div, data){
		// Create chart instance
		var chart = am4core.create(div, am4charts.XYChart);
		// Add data
		chart.data = data;
		
		var categoryAxis = chart.xAxes.push(new am4charts.CategoryAxis());
		categoryAxis.dataFields.category = "date";
		categoryAxis.renderer.minGridDistance = 10;
		
		
		var valueAxis = chart.yAxes.push(new am4charts.ValueAxis());
		
		// Create series
		var series = chart.series.push(new am4charts.LineSeries());
		series.dataFields.valueY = "value1";
		series.dataFields.categoryX = "date";
		series.strokeWidth = 2;
		series.minBulletDistance = 10;
		series.tooltipText = "[bold]객단가:[/] {value1}";
		series.tooltip.pointerOrientation = "vertical";
		
		// Add cursor
		chart.cursor = new am4charts.XYCursor();
		//chart.cursor.xAxis = dateAxis;  
		chart.cursor.xAxis = categoryAxis;  
	 }
	
	function numberWithCommas(n) {
		if(n == null || n == "") {
			return "0";
		} else {
			return n.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
		}
	}
</script>
